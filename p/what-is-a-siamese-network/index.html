<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="An algorithm you use EVERYDAY! This is a powerful technique that enables biometric authentication and advanced feature matching! Learn more‚Ä¶"><title>What is a Siamese Network? (Implementation Included)</title><link rel=canonical href=https://thought.krishnashah.dev/p/what-is-a-siamese-network/><link rel=stylesheet href=/scss/style.min.833d6eed45de56f48306bf57268d5b8cdfc8a60e8e7bdc99810464fcd033f7c6.css><meta property='og:title' content="What is a Siamese Network? (Implementation Included)"><meta property='og:description' content="An algorithm you use EVERYDAY! This is a powerful technique that enables biometric authentication and advanced feature matching! Learn more‚Ä¶"><meta property='og:url' content='https://thought.krishnashah.dev/p/what-is-a-siamese-network/'><meta property='og:site_name' content='Thoughts From a Dragonfly'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='Tensorflow'><meta property='article:tag' content='AI'><meta property='article:tag' content='Python'><meta property='article:published_time' content='2023-06-09T00:00:00+00:00'><meta property='article:modified_time' content='2023-06-09T00:00:00+00:00'><meta property='og:image' content='https://thought.krishnashah.dev/p/what-is-a-siamese-network/cover.webp'><meta name=twitter:title content="What is a Siamese Network? (Implementation Included)"><meta name=twitter:description content="An algorithm you use EVERYDAY! This is a powerful technique that enables biometric authentication and advanced feature matching! Learn more‚Ä¶"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://thought.krishnashah.dev/p/what-is-a-siamese-network/cover.webp'><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_3706edba391e6d38.png width=300 height=321 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>üß†</span></figure><div class=site-meta><h1 class=site-name><a href=/>Thoughts From a Dragonfly</a></h1><h2 class=site-description>Premier place to hear the thoughts of a mere Dragonfly who learned to outlive the dinosaurs.</h2></div></header><ol class=menu-social><li><a href=https://github.com/DragonflyRobotics target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://krishnashah.dev target=_blank title=Home rel=me><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#introduction>Introduction</a></li><li><a href=#what-is-the-architecture-of-a-siamese-network>What is the architecture of a Siamese Network?</a><ol><li><a href=#loss-function>Loss Function</a></li></ol></li><li><a href=#implementation>Implementation</a></li><li><a href=#conclusion>Conclusion</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/what-is-a-siamese-network/><img src=/p/what-is-a-siamese-network/cover_hu_c1cffb70b04c764e.webp srcset="/p/what-is-a-siamese-network/cover_hu_c1cffb70b04c764e.webp 800w, /p/what-is-a-siamese-network/cover_hu_a022236513867945.webp 1600w" width=800 height=719 loading=lazy alt="Featured image of post What is a Siamese Network? (Implementation Included)"></a></div><div class=article-details><header class=article-category><a href=/categories/tensorflow/>Tensorflow
</a><a href=/categories/ai/>AI
</a><a href=/categories/python/>Python</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/what-is-a-siamese-network/>What is a Siamese Network? (Implementation Included)</a></h2><h3 class=article-subtitle>An algorithm you use EVERYDAY! This is a powerful technique that enables biometric authentication and advanced feature matching! Learn more‚Ä¶</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published datetime=2023-06-09T00:00:00Z>Jun 09, 2023</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>6 minute read</time></div></footer></div></header><section class=article-content><h2 id=introduction>Introduction</h2><p>Chances are you have heard of a convolutional neural network (CNN). A network that revolves a kernel around an image to extract features and spatially interpret the image. These networks are some of the most prominent networks in the AI Industry, with applications in object detection, image processing, feature extraction, background removal, and image reconstruction and generation. With a minor but ingenious modification, these relatively primitive networks can be capable of an entirely novel niche of deep learning tasks enabling some powerful modern technologies like biometric authentication.</p><h2 id=what-is-the-architecture-of-a-siamese-network>What is the architecture of a Siamese Network?</h2><p>The architecture of a Siamese Network consists of two convolutional neural networks that run in parallel on two different images. Furthermore, these two CNNs have identical weights and biases, allowing them to use similar extracted features to analyze differently.</p><p><img src=/p/what-is-a-siamese-network/1.webp width=512 height=178 srcset="/p/what-is-a-siamese-network/1_hu_4c863ebcb989bdd9.webp 480w, /p/what-is-a-siamese-network/1_hu_619e35f0ad285049.webp 1024w" loading=lazy class=gallery-image data-flex-grow=287 data-flex-basis=690px></p><p>We value two separate images, ground truth, and an ‚Äúimposter‚Äù, with the same feature extractors and loss function to return an arbitrary similarity unit. To understand this concept further, it is imperative to understand the loss function governing the network.</p><h3 id=loss-function>Loss Function</h3><p>These networks typically use one of two loss functions: Contrastive Loss and Euclidean Loss.</p><p><strong>Euclidean Loss</strong>
<img src=/p/what-is-a-siamese-network/2.webp width=982 height=128 srcset="/p/what-is-a-siamese-network/2_hu_c000498b50a4f864.webp 480w, /p/what-is-a-siamese-network/2_hu_92279fe03ec6f5dc.webp 1024w" loading=lazy class=gallery-image data-flex-grow=767 data-flex-basis=1841px></p><p>y = one of the CNN outputs</p><p>y_hat = the other CNN output</p><p>T = ground truth value (array of 1s or 0s)</p><p>This is the classic example of the ‚Äúdistance formula‚Äù applied to higher dimensions through matrices. We take a point in a high-dimension plane (i.e., the size of y and y_hat) and compute their Euclidean distance. This is a simple ‚Äî but effective ‚Äî technique to find the distance.</p><p><strong>Contrastive Loss</strong>
<img src=/p/what-is-a-siamese-network/3.webp width=700 height=77 srcset="/p/what-is-a-siamese-network/3_hu_5cd3e47520c46cd6.webp 480w, /p/what-is-a-siamese-network/3_hu_3857275f1352067b.webp 1024w" loading=lazy class=gallery-image data-flex-grow=909 data-flex-basis=2181px></p><p>D_w ‚Äî Distance between points</p><p>Y ‚Äî Truth value (0 = not related; 1 = related)</p><p>This loss function has two terms: one is responsible for rewarding the algorithm for having points closer together, while the other returns 0 if the points are farther out. This is made more apparent when the 1/2 normalization terms are removed.</p><h2 id=implementation>Implementation</h2><p>With the theory out of the way, it is time for practical implementation. This implementation will be done in Tensorflow, but the PyTorch implementation should be similar in concept.</p><p>The first task is to import libraries and do the initial setup. My setup consists of a <code>Data</code> folder with subfolders for each of the categories.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python3 data-lang=python3><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pathlib</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>tensorflow</span> <span class=k>as</span> <span class=nn>tf</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;TensorFlow version:&#34;</span><span class=p>,</span> <span class=n>tf</span><span class=o>.</span><span class=n>__version__</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tensorflow.keras.layers</span> <span class=kn>import</span> <span class=n>Dense</span><span class=p>,</span> <span class=n>Flatten</span><span class=p>,</span> <span class=n>Conv2D</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>AUTOTUNE</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>AUTOTUNE</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>dirs</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>listdir</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>pathlib</span><span class=o>.</span><span class=n>Path</span><span class=p>(</span><span class=s2>&#34;Data&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>resolve</span><span class=p>()))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>train_ds_arr</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>BATCH_SIZE</span> <span class=o>=</span> <span class=mi>32</span>
</span></span></code></pre></td></tr></table></div></div><p>Next, we need to create the class that will define the layers of the network and the forward pass.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python3 data-lang=python3><span class=line><span class=cl><span class=k>class</span> <span class=nc>SiameseNet</span><span class=p>(</span><span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>models</span><span class=o>.</span><span class=n>Model</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>(</span><span class=n>SiameseNet</span><span class=p>,</span> <span class=bp>self</span><span class=p>)</span><span class=o>.</span><span class=fm>__init__</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>conv1</span> <span class=o>=</span> <span class=n>Conv2D</span><span class=p>(</span><span class=mi>64</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=n>activation</span><span class=o>=</span><span class=s1>&#39;relu&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>conv2</span> <span class=o>=</span> <span class=n>Conv2D</span><span class=p>(</span><span class=mi>32</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=n>activation</span><span class=o>=</span><span class=s1>&#39;relu&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>conv3</span> <span class=o>=</span> <span class=n>Conv2D</span><span class=p>(</span><span class=mi>64</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=n>activation</span><span class=o>=</span><span class=s1>&#39;relu&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>flatten</span> <span class=o>=</span> <span class=n>Flatten</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>d1</span> <span class=o>=</span> <span class=n>Dense</span><span class=p>(</span><span class=mi>128</span><span class=p>,</span> <span class=n>activation</span><span class=o>=</span><span class=s1>&#39;relu&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>d2</span> <span class=o>=</span> <span class=n>Dense</span><span class=p>(</span><span class=mi>64</span><span class=p>,</span> <span class=n>activation</span><span class=o>=</span><span class=s1>&#39;relu&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>d3</span> <span class=o>=</span> <span class=n>Dense</span><span class=p>(</span><span class=mi>32</span><span class=p>,</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>call</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x1</span><span class=p>,</span> <span class=n>x2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># x1 = self.conv1(x1)</span>
</span></span><span class=line><span class=cl>        <span class=c1># x1 = self.conv2(x1)</span>
</span></span><span class=line><span class=cl>        <span class=n>x1</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>conv3</span><span class=p>(</span><span class=n>x1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>x1</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>flatten</span><span class=p>(</span><span class=n>x1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>x1</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>d1</span><span class=p>(</span><span class=n>x1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>x1</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>d2</span><span class=p>(</span><span class=n>x1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>x1</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>d3</span><span class=p>(</span><span class=n>x1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># x2 = self.conv1(x2)</span>
</span></span><span class=line><span class=cl>        <span class=c1># x2 = self.conv2(x2)</span>
</span></span><span class=line><span class=cl>        <span class=n>x2</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>conv3</span><span class=p>(</span><span class=n>x2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>x2</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>flatten</span><span class=p>(</span><span class=n>x2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>x2</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>d1</span><span class=p>(</span><span class=n>x2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>x2</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>d2</span><span class=p>(</span><span class=n>x2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>x2</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>d3</span><span class=p>(</span><span class=n>x2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>x1</span><span class=p>,</span> <span class=n>x2</span>
</span></span></code></pre></td></tr></table></div></div><p>I have commented on the first two layers for computational simplicity (and image size limitations), but they can be used if needed. Additionally, the forward pass requires two arguments (namely <code>x1</code> and <code>x2</code>). This is because we use the same layers, thus the same weights and biases, in the forward pass of both images.</p><p>We can now make an object of the class and initialize the optimizer.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python3 data-lang=python3><span class=line><span class=cl><span class=n>snn</span> <span class=o>=</span> <span class=n>SiameseNet</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>optimizer</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>optimizers</span><span class=o>.</span><span class=n>Adam</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>We must now create three functions to process the data and generate training batches.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python3 data-lang=python3><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_label</span><span class=p>(</span><span class=n>file_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>parts</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>strings</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>file_path</span><span class=p>,</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>sep</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>one_hot</span> <span class=o>=</span> <span class=n>parts</span><span class=p>[</span><span class=o>-</span><span class=mi>2</span><span class=p>]</span> <span class=o>==</span> <span class=n>dirs</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>tf</span><span class=o>.</span><span class=n>argmax</span><span class=p>(</span><span class=n>one_hot</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>decode_img</span><span class=p>(</span><span class=n>img</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>io</span><span class=o>.</span><span class=n>decode_jpeg</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=n>channels</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>tf</span><span class=o>.</span><span class=n>image</span><span class=o>.</span><span class=n>resize</span><span class=p>(</span><span class=n>img</span><span class=p>,</span> <span class=p>[</span><span class=mi>170</span><span class=p>,</span> <span class=mi>170</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>process_path</span><span class=p>(</span><span class=n>file_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>label</span> <span class=o>=</span> <span class=n>get_label</span><span class=p>(</span><span class=n>file_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>io</span><span class=o>.</span><span class=n>read_file</span><span class=p>(</span><span class=n>file_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>img</span> <span class=o>=</span> <span class=n>decode_img</span><span class=p>(</span><span class=n>img</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>img</span><span class=p>,</span> <span class=n>label</span>
</span></span></code></pre></td></tr></table></div></div><p>The <code>get_label</code> function is responsible for using the file path to create an integer label for each category in the <code>Data</code> folder. The <code>decode_img</code> function is responsible for loading an image into TensorFlow and resizing it. Finally, the <code>process_path</code> function takes a given path, reads the file, decodes the image, and returns the modified image with its label.</p><p>Next, we must create TensorFlow datasets of the images for each directory and create a parent array to hold them.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python3 data-lang=python3><span class=line><span class=cl><span class=k>for</span> <span class=n>d</span> <span class=ow>in</span> <span class=n>dirs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>data_dir</span> <span class=o>=</span> <span class=n>pathlib</span><span class=o>.</span><span class=n>Path</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;Data&#34;</span><span class=p>,</span> <span class=n>d</span><span class=p>))</span><span class=o>.</span><span class=n>with_suffix</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>Dataset</span><span class=o>.</span><span class=n>list_files</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>data_dir</span> <span class=o>/</span> <span class=s1>&#39;*&#39;</span><span class=p>),</span> <span class=n>shuffle</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>x</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=n>process_path</span><span class=p>,</span> <span class=n>num_parallel_calls</span><span class=o>=</span><span class=n>AUTOTUNE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>train_ds_arr</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Here, we map the listed files using out <code>process_path</code> function to create a dataset with images and labels.</p><p>We can now compile our model, set up metrics, and initialize callbacks.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python3 data-lang=python3><span class=line><span class=cl><span class=n>train_loss</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>metrics</span><span class=o>.</span><span class=n>Mean</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s1>&#39;train_loss&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>tb_callback</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>callbacks</span><span class=o>.</span><span class=n>TensorBoard</span><span class=p>(</span><span class=s2>&#34;tensorboard&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>tb_callback</span><span class=o>.</span><span class=n>set_model</span><span class=p>(</span><span class=n>snn</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Most importantly, we need to create a loss function I discussed earlier. For the sake of simplicity, I will use the Euclidean loss:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python3 data-lang=python3><span class=line><span class=cl><span class=nd>@tf.function</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>euclidean</span><span class=p>(</span><span class=n>y1</span><span class=p>,</span> <span class=n>y2</span><span class=p>,</span> <span class=n>T</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>y1</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>convert_to_tensor</span><span class=p>(</span><span class=n>y1</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=s1>&#39;float32&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>y2</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>convert_to_tensor</span><span class=p>(</span><span class=n>y2</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=s1>&#39;float32&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>diff</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>pow</span><span class=p>(</span><span class=n>tf</span><span class=o>.</span><span class=n>subtract</span><span class=p>(</span><span class=n>y1</span><span class=p>,</span> <span class=n>y2</span><span class=p>),</span> <span class=mf>2.0</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>    <span class=n>truth</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>ones</span><span class=p>(</span><span class=n>diff</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=s1>&#39;float32&#39;</span><span class=p>)</span> <span class=k>if</span> <span class=n>T</span> <span class=o>==</span> <span class=mi>1</span> <span class=k>else</span> <span class=n>tf</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>diff</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=s1>&#39;float32&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>tf</span><span class=o>.</span><span class=n>pow</span><span class=p>(</span><span class=n>tf</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>tf</span><span class=o>.</span><span class=n>tensordot</span><span class=p>(</span><span class=n>diff</span><span class=p>,</span> <span class=n>truth</span><span class=p>,</span> <span class=n>axes</span><span class=o>=</span><span class=nb>len</span><span class=p>(</span><span class=n>diff</span><span class=o>.</span><span class=n>shape</span><span class=p>))),</span> <span class=mf>2.0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>tf</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>run_functions_eagerly</span><span class=p>(</span><span class=n>euclidean</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Finally, add the training code.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python3 data-lang=python3><span class=line><span class=cl><span class=nd>@tf.function</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>train</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>index1</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>train_ds_arr</span><span class=p>)</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>index2</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>train_ds_arr</span><span class=p>)</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>T</span> <span class=o>=</span> <span class=mi>0</span> <span class=k>if</span> <span class=n>index1</span> <span class=o>==</span> <span class=n>index2</span> <span class=k>else</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=n>img1</span><span class=p>,</span> <span class=n>label1</span><span class=p>),</span> <span class=p>(</span><span class=n>img2</span><span class=p>,</span> <span class=n>label2</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>train_ds_arr</span><span class=p>[</span><span class=n>index1</span><span class=p>]</span><span class=o>.</span><span class=n>take</span><span class=p>(</span><span class=n>BATCH_SIZE</span><span class=p>),</span> <span class=n>train_ds_arr</span><span class=p>[</span><span class=n>index2</span><span class=p>]</span><span class=o>.</span><span class=n>take</span><span class=p>(</span><span class=n>BATCH_SIZE</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>            <span class=n>img1</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>expand_dims</span><span class=p>(</span><span class=n>img1</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span> <span class=o>/</span> <span class=mf>255.0</span>
</span></span><span class=line><span class=cl>            <span class=n>img2</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>expand_dims</span><span class=p>(</span><span class=n>img2</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span> <span class=o>/</span> <span class=mf>255.0</span>
</span></span><span class=line><span class=cl>            <span class=k>with</span> <span class=n>tf</span><span class=o>.</span><span class=n>GradientTape</span><span class=p>()</span> <span class=k>as</span> <span class=n>tape</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>predictions</span> <span class=o>=</span> <span class=n>snn</span><span class=p>(</span><span class=n>img1</span><span class=p>,</span> <span class=n>img2</span><span class=p>,</span> <span class=n>training</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>loss</span> <span class=o>=</span> <span class=n>euclidean</span><span class=p>(</span><span class=n>predictions</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>predictions</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>T</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>gradients</span> <span class=o>=</span> <span class=n>tape</span><span class=o>.</span><span class=n>gradient</span><span class=p>(</span><span class=n>loss</span><span class=p>,</span> <span class=n>snn</span><span class=o>.</span><span class=n>trainable_variables</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>optimizer</span><span class=o>.</span><span class=n>apply_gradients</span><span class=p>(</span><span class=nb>zip</span><span class=p>(</span><span class=n>gradients</span><span class=p>,</span> <span class=n>snn</span><span class=o>.</span><span class=n>trainable_variables</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>loss</span><span class=o>.</span><span class=n>numpy</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Here, we are randomly selecting a class from our master dataset array and ‚Äî using a ternary ‚Äî we compute whether the datasets are the same or different, which will be used as the truth value in the loss function. We select the batch and normalize the image values. Finally, we compute the forward pass and loss with <code>GradientTape</code>. The final lines compute the partial derivatives via automatic differentiation and apply these gradients to the optimizer.</p><h2 id=conclusion>Conclusion</h2><p>This shows just how simple and powerful Siamese Networks are. The networks are not just limited to images but can be applied to all forms of time-independent data that can be convolved. In fact, it is also possible to use Siamese networks without their convolutional component as simple Linear networks with a comparator (the loss function); however, it may function worse and is uncommon.</p></section><footer class=article-footer><section class=article-tags><a href=/tags/tensorflow/>Tensorflow</a>
<a href=/tags/ai/>AI</a>
<a href=/tags/python/>Python</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/p/you-know-10-percent-of-tensorflow-here-is-the-90/><div class=article-image><img src=/p/you-know-10-percent-of-tensorflow-here-is-the-90/cover.7ddba39cc6a190539c673740529c3720_hu_6fb0f564da4dcc0d.webp width=250 height=150 loading=lazy alt="Featured image of post You know 10% of TensorFlow; Here is the 90%" data-key=you-know-10-percent-of-tensorflow-here-is-the-90 data-hash="md5-fdujnMahkFOcZzdAUpw3IA=="></div><div class=article-details><h2 class=article-title>You know 10% of TensorFlow; Here is the 90%</h2></div></a></article><article class=has-image><a href=/p/what-really-is-general-intelligence/><div class=article-image><img src=/p/what-really-is-general-intelligence/cover.2d6b802d3fa1aed3aa611a204c8fd2dd_hu_ea445bd25a903e35.webp width=250 height=150 loading=lazy alt="Featured image of post What REALLY is General Intelligence?" data-key=what-really-is-general-intelligence data-hash="md5-LWuALT+hrtOqYRogTI/S3Q=="></div><div class=article-details><h2 class=article-title>What REALLY is General Intelligence?</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//hugo-theme-stack.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2025 Thoughts From a Dragonfly</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.33.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.c922af694cc257bf1ecc41c0dd7b0430f9114ec280ccf67cd2c6ad55f5316c4e.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>